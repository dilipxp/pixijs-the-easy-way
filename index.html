<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@8.x/dist/pixi.min.js"></script>
  </head>
  <body>
    <script type="module">
      const Application = PIXI.Application;
      const Assets = PIXI.Assets;
      const Sprite = PIXI.Sprite;
      const Graphics = PIXI.Graphics;
      const Container = PIXI.Container;

      //   PIXI Application
      const app = new Application();
      await app.init({ resizeTo: window, backgroundColor: "0xf2efee" });
      document.body.appendChild(app.canvas);

      //   PIXI Container
      const container1 = new Container();

      //   PIXI Graphics
      const graphics = new Graphics();
      graphics.rect(50, 50, 100, 100);
      graphics.fill("#220869");
      graphics.interactive = true;
      graphics.buttonMode = true;

      app.stage.addChild(graphics);

      graphics.on("pointerup", () => {
        const hexCode = `#${Math.floor(Math.random() * 0xffffff)
          .toString(16)
          .padStart(6, "0")}`;
        graphics.drawRect(50, 50, 100, 100);
        graphics.beginFill(`${hexCode}`);
        graphics.endFill();
        console.log(hexCode);
      });

      // PIXI Label
      const label = new PIXI.Text("Tap to change the color", {
        fontFamily: "Arial",
        fontSize: 18,
        fill: "0x000000",
        align: "center",
      });

      label.x = 100;
      label.y = 180;
      label.anchor.set("0.5");
      container1.addChild(label, graphics);

      // Another example of loading
      Assets.addBundle("images", [
        { alias: "bunny", src: "./images/bunny.png" },
        { alias: "onBtn", src: "./images/on.png" },
        { alias: "offBtn", src: "./images/off.png" },
      ]);

      const assets = await Assets.loadBundle("images");

      const rabbitSpirte = new PIXI.Sprite(assets.bunny);
      app.stage.addChild(rabbitSpirte);
      rabbitSpirte.anchor.set(0.5);

      rabbitSpirte.x = 500;
      rabbitSpirte.y = 100;

      // Button
      const onButton = new PIXI.Sprite(assets.onBtn);
      onButton.anchor.set(0.5);
      onButton.x = 400;
      onButton.y = 250;
      app.stage.addChild(onButton);

      onButton.interactive = true;
      onButton.buttonMode = true;
      let rotationSpeed = 0.002;

      const offButton = new PIXI.Sprite(assets.offBtn);
      offButton.anchor.set(0.5);
      offButton.x = 600;
      offButton.y = 250;
      app.stage.addChild(offButton);

      offButton.interactive = true;
      offButton.buttonMode = true;
      // const rotationSpeed = 0.002;

      offButton.on("pointerdown", () => {
        rotationSpeed = 0;
        offButton.scale.set(1.2);
        onButton.scale.set(1);
      });

      onButton.on("pointerdown", () => {
        offButton.scale.set(1);
        onButton.scale.set(1.2);
        rotationSpeed = 0.02;
        app.ticker.add(() => {
          rabbitSpirte.rotation += rotationSpeed;
        });
      });

      const label1 = new PIXI.Text("click to spin bunny", {
        fontFamily: "Arial",
        fontSize: 18,
        fill: "0x000000",
        align: "center",
      });

      label1.x = 400;
      label1.y = 320;
      label1.anchor.set("0.5");

      const label2 = new PIXI.Text("click to stop bunny", {
        fontFamily: "Arial",
        fontSize: 18,
        fill: "0x000000",
        align: "center",
      });

      label2.x = 600;
      label2.y = 320;
      label2.anchor.set("0.5");
      app.stage.addChild(container1, label1, label2);

      //   Animated spine example
      const fighterJetSheet = await PIXI.Assets.load("./images/fighter.json");

      const frames = [];

      for (let i = 0; i < 30; i++) {
        const val = i < 10 ? `0${i}` : i;
        frames.push(PIXI.Texture.from(`rollSequence00${val}.png`));
      }

      const anim = new PIXI.AnimatedSprite(frames);
      anim.x = app.screen.width / 2;
      anim.y = 500;
      anim.anchor.set(0.5);
      anim.animationSpeed = 0.5;
      anim.play();
      app.stage.addChild(anim);

      app.ticker.add(() => {
        anim.rotation += 0.01;
      });
    </script>
  </body>
</html>
